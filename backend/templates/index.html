<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Restaurant Management System</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD8i4ysTO8mgS2YyuY-O06EVQCty-ld_Pw"></script>

</head>
<body>
  <h1>Restaurant Management System</h1>

  <form id="add-form">
    <input type="text" id="address" placeholder="Enter address">
    <button type="submit">Add Address</button>
  </form>

  <table id="address-table">
    <thead>
      <tr>
        <th>Address</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <!-- Address rows will be dynamically generated here -->
    </tbody>
  </table>

  <script>
    // Function to handle form submission and send address data to the server
    function handleFormSubmit(event) {
      event.preventDefault();
      const addressInput = document.getElementById('address');
      const address = addressInput.value;
  
      // Send the address data to the server
      fetch('/api/user_input', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ address }),
      })
        .then(response => response.json())
        .then(data => {
          console.log(data.message);
          // Handle the server response as needed
        })
        .catch(error => {
          console.error('Error:', error);
          // Handle errors
        });
  
      // Clear the input field
      addressInput.value = '';
  
      // Add the new address row dynamically
      const tbody = document.querySelector('#address-table tbody');
      const newRow = generateAddressRow(address);
      tbody.appendChild(newRow);
    }
  
    // Function to dynamically generate a row for an address
    function generateAddressRow(address) {
      const row = document.createElement('tr');
  
      const addressCell = document.createElement('td');
      addressCell.textContent = address;
  
      const actionsCell = document.createElement('td');
      const deleteButton = document.createElement('button');
      deleteButton.textContent = 'Delete';
      deleteButton.addEventListener('click', () => {
        // Perform the necessary logic to delete the address using the backend code
        row.remove(); // Remove the row from the table
      });
      actionsCell.appendChild(deleteButton);
  
      row.appendChild(addressCell);
      row.appendChild(actionsCell);
  
      return row;
    }
  
    // Function to fetch the initial addresses from the backend
    async function fetchInitialAddresses() {
      try {
        const response = await fetch('/api/addresses');
        if (response.ok) {
          const addresses = await response.json();
          return addresses;
        } else {
          console.error('Error:', response.status);
          return [];
        }
      } catch (error) {
        console.error('Error:', error);
        return [];
      }
    }
  
    // Initial setup when the page loads
    document.addEventListener('DOMContentLoaded', async () => {
      const addForm = document.getElementById('add-form');
      addForm.addEventListener('submit', handleFormSubmit);
  
      // Retrieve the existing addresses from the backend and populate the table
      const initialAddresses = await fetchInitialAddresses();
      const addressTable = document.getElementById('address-table');
      const tbody = addressTable.querySelector('tbody');
  
      initialAddresses.forEach(address => {
        const row = generateAddressRow(address);
        tbody.appendChild(row);
      });
  
      // Call the user_input function from the backend to handle user input
      fetch('/api/user_input', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ command: 'user_input' }),
      })
        .then(response => response.json())
        .then(data => {
          console.log(data.message);
          // Handle the server response as needed
        })
        .catch(error => {
          console.error('Error:', error);
          // Handle errors
        });
    });
  </script>
  
</body>
</html>
